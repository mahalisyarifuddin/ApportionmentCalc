<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kalkulator Konversi Suara: Sainte LaguÃ« vs Kuota Hare</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 10px;
            font-size: 28px;
        }
        
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 14px;
        }
        
        .input-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            color: #333;
            font-weight: 600;
        }
        
        input[type="number"], input[type="text"] {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        input[type="number"]:focus, input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .party-inputs {
            margin-top: 20px;
        }
        
        .party-row {
            display: grid;
            grid-template-columns: 2fr 3fr 60px;
            gap: 10px;
            margin-bottom: 10px;
            align-items: center;
        }
        
        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            transition: background 0.3s;
            font-weight: 600;
        }
        
        button:hover {
            background: #5568d3;
        }
        
        .btn-remove {
            background: #dc3545;
            padding: 10px;
            font-size: 14px;
        }
        
        .btn-remove:hover {
            background: #c82333;
        }
        
        .btn-add {
            background: #28a745;
            margin-top: 10px;
        }
        
        .btn-add:hover {
            background: #218838;
        }
        
        .btn-calculate {
            width: 100%;
            margin-top: 20px;
            padding: 15px;
            font-size: 18px;
        }
        
        .results {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 30px;
        }
        
        .result-box {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid #667eea;
        }
        
        .result-box h2 {
            color: #333;
            margin-bottom: 15px;
            font-size: 22px;
        }
        
        .result-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .result-table th,
        .result-table td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        .result-table th {
            background: #667eea;
            color: white;
            font-weight: 600;
        }
        
        .result-table tr:hover {
            background: #f1f3f5;
        }
        
        .calculation-steps {
            margin-top: 30px;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
        }
        
        .calculation-steps h3 {
            color: #333;
            margin-bottom: 15px;
        }
        
        .step {
            margin-bottom: 15px;
            padding: 10px;
            background: white;
            border-radius: 5px;
            border-left: 3px solid #667eea;
        }
        
        .comparison {
            margin-top: 30px;
            padding: 20px;
            background: #fff3cd;
            border-radius: 10px;
            border-left: 5px solid #ffc107;
        }
        
        .comparison h3 {
            color: #856404;
            margin-bottom: 10px;
        }
        
        @media (max-width: 768px) {
            .results {
                grid-template-columns: 1fr;
            }
            
            .party-row {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 22px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Kalkulator Konversi Suara</h1>
        <p class="subtitle">Metode Sainte LaguÃ« vs Kuota Hare</p>
        
        <div class="input-section">
            <div class="form-group">
                <label for="totalSeats">Jumlah Kursi Tersedia:</label>
                <input type="number" id="totalSeats" value="12" min="1">
            </div>
            
            <div class="party-inputs" id="partyInputs">
                <h3 style="margin-bottom: 15px; color: #333;">Perolehan Suara Partai:</h3>
            </div>
            
            <button class="btn-add" onclick="addParty()">+ Tambah Partai</button>
            <button class="btn-calculate" onclick="calculate()">Hitung Perolehan Kursi</button>
        </div>
        
        <div id="resultsContainer"></div>
    </div>

    <script>
        let partyCount = 0;
        
        function initializeDefaultParties() {
            const defaultParties = [
                {name: 'Partai A', votes: 15000},
                {name: 'Partai B', votes: 12000},
                {name: 'Partai C', votes: 8000}
            ];
            
            defaultParties.forEach(party => {
                addParty(party.name, party.votes);
            });
        }
        
        function addParty(name = '', votes = 0) {
            partyCount++;
            const partyInputs = document.getElementById('partyInputs');
            const partyRow = document.createElement('div');
            partyRow.className = 'party-row';
            partyRow.id = `party-${partyCount}`;
            partyRow.innerHTML = `
                <input type="text" placeholder="Nama Partai" value="${name}" id="name-${partyCount}">
                <input type="number" placeholder="Jumlah Suara" value="${votes}" min="0" id="votes-${partyCount}">
                <button class="btn-remove" onclick="removeParty(${partyCount})">Hapus</button>
            `;
            partyInputs.appendChild(partyRow);
        }
        
        function removeParty(id) {
            const partyRow = document.getElementById(`party-${id}`);
            if (partyRow) {
                partyRow.remove();
            }
        }
        
        function getParties() {
            const parties = [];
            const partyRows = document.querySelectorAll('.party-row');
            partyRows.forEach(row => {
                const id = row.id.split('-')[1];
                const name = document.getElementById(`name-${id}`).value;
                const votes = parseInt(document.getElementById(`votes-${id}`).value) || 0;
                if (name && votes > 0) {
                    parties.push({name, votes});
                }
            });
            return parties;
        }
        
        function calculateKuotaHare(parties, totalSeats) {
            const totalVotes = parties.reduce((sum, p) => sum + p.votes, 0);
            const bpp = totalVotes / totalSeats;
            
            const results = parties.map(party => {
                const fullSeats = Math.floor(party.votes / bpp);
                const remainder = party.votes - (fullSeats * bpp);
                return {
                    name: party.name,
                    votes: party.votes,
                    fullSeats: fullSeats,
                    remainder: remainder,
                    totalSeats: fullSeats
                };
            });
            
            let allocatedSeats = results.reduce((sum, r) => sum + r.fullSeats, 0);
            const remainingSeats = totalSeats - allocatedSeats;
            
            // Alokasikan kursi sisa berdasarkan sisa suara terbanyak
            const sortedByRemainder = [...results].sort((a, b) => b.remainder - a.remainder);
            for (let i = 0; i < remainingSeats; i++) {
                sortedByRemainder[i].totalSeats++;
            }
            
            return {
                results: results.sort((a, b) => b.totalSeats - a.totalSeats),
                bpp: bpp,
                totalVotes: totalVotes
            };
        }
        
        function calculateSainteLague(parties, totalSeats) {
            const results = parties.map(party => ({
                name: party.name,
                votes: party.votes,
                seats: 0
            }));
            
            const steps = [];
            
            for (let seat = 1; seat <= totalSeats; seat++) {
                let maxQuotient = 0;
                let winnerIndex = 0;
                
                const quotients = results.map((party, index) => {
                    const divisor = 2 * party.seats + 1;
                    const quotient = party.votes / divisor;
                    
                    if (quotient > maxQuotient) {
                        maxQuotient = quotient;
                        winnerIndex = index;
                    }
                    
                    return {
                        party: party.name,
                        quotient: quotient.toFixed(2),
                        divisor: divisor
                    };
                });
                
                results[winnerIndex].seats++;
                
                steps.push({
                    seatNumber: seat,
                    winner: results[winnerIndex].name,
                    quotient: maxQuotient.toFixed(2),
                    quotients: quotients
                });
            }
            
            return {
                results: results.sort((a, b) => b.seats - a.seats),
                steps: steps
            };
        }
        
        function displayResults(hareResults, sainteLagueResults) {
            const container = document.getElementById('resultsContainer');
            
            let html = '<div class="results">';
            
            // Kuota Hare Results
            html += `
                <div class="result-box">
                    <h2>Metode Kuota Hare</h2>
                    <p style="margin-bottom: 10px; color: #666;">
                        <strong>BPP:</strong> ${hareResults.bpp.toFixed(2)}<br>
                        <strong>Total Suara:</strong> ${hareResults.totalVotes.toLocaleString()}
                    </p>
                    <table class="result-table">
                        <thead>
                            <tr>
                                <th>Partai</th>
                                <th>Suara</th>
                                <th>Kursi</th>
                                <th>Sisa</th>
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            hareResults.results.forEach(party => {
                html += `
                    <tr>
                        <td>${party.name}</td>
                        <td>${party.votes.toLocaleString()}</td>
                        <td><strong>${party.totalSeats}</strong></td>
                        <td>${party.remainder.toFixed(0)}</td>
                    </tr>
                `;
            });
            
            html += `
                        </tbody>
                    </table>
                </div>
            `;
            
            // Sainte LaguÃ« Results
            html += `
                <div class="result-box">
                    <h2>Metode Sainte LaguÃ«</h2>
                    <p style="margin-bottom: 10px; color: #666;">
                        Pembagi: 1, 3, 5, 7, 9, ...
                    </p>
                    <table class="result-table">
                        <thead>
                            <tr>
                                <th>Partai</th>
                                <th>Suara</th>
                                <th>Kursi</th>
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            sainteLagueResults.results.forEach(party => {
                html += `
                    <tr>
                        <td>${party.name}</td>
                        <td>${party.votes.toLocaleString()}</td>
                        <td><strong>${party.seats}</strong></td>
                    </tr>
                `;
            });
            
            html += `
                        </tbody>
                    </table>
                </div>
            </div>
            `;
            
            // Comparison
            html += '<div class="comparison"><h3>ðŸ“Š Perbandingan Hasil</h3>';
            html += '<table class="result-table" style="background: white;"><thead><tr><th>Partai</th><th>Kuota Hare</th><th>Sainte LaguÃ«</th><th>Selisih</th></tr></thead><tbody>';
            
            const allParties = new Set([
                ...hareResults.results.map(p => p.name),
                ...sainteLagueResults.results.map(p => p.name)
            ]);
            
            allParties.forEach(partyName => {
                const hareSeats = hareResults.results.find(p => p.name === partyName)?.totalSeats || 0;
                const slSeats = sainteLagueResults.results.find(p => p.name === partyName)?.seats || 0;
                const diff = slSeats - hareSeats;
                const diffText = diff > 0 ? `+${diff}` : diff < 0 ? diff : '0';
                const diffColor = diff > 0 ? 'green' : diff < 0 ? 'red' : 'gray';
                
                html += `
                    <tr>
                        <td>${partyName}</td>
                        <td>${hareSeats}</td>
                        <td>${slSeats}</td>
                        <td style="color: ${diffColor}; font-weight: bold;">${diffText}</td>
                    </tr>
                `;
            });
            
            html += '</tbody></table></div>';
            
            container.innerHTML = html;
        }
        
        function calculate() {
            const parties = getParties();
            const totalSeats = parseInt(document.getElementById('totalSeats').value);
            
            if (parties.length === 0) {
                alert('Masukkan minimal 1 partai!');
                return;
            }
            
            if (totalSeats < 1) {
                alert('Jumlah kursi harus minimal 1!');
                return;
            }
            
            const hareResults = calculateKuotaHare(parties, totalSeats);
            const sainteLagueResults = calculateSainteLague(parties, totalSeats);
            
            displayResults(hareResults, sainteLagueResults);
        }
        
        // Initialize with default parties
        initializeDefaultParties();
    </script>
</body>
</html>
